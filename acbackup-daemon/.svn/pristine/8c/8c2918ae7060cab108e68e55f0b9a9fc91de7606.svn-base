package sga.sol.ac.acotp.daemon.server;

import java.util.HashMap;
import java.util.Map;

import org.mybatis.spring.SqlSessionTemplate;

public class SaveServerProperty {
	private ServerProperty serverProperty;
	private SqlSessionTemplate sqlSessionTemplate;
	
	public void setServerProperty(ServerProperty serverProperty) {
		this.serverProperty = serverProperty;
	}
	public void setSqlSessionTemplate(SqlSessionTemplate sqlSessionTemplate) {
		this.sqlSessionTemplate = sqlSessionTemplate;
	}
	
	public void save(){
		sqlSessionTemplate.delete("removeAcotpConfiguration");

		Map<String,String> param = new HashMap<String, String>();
		
		param.put("configKey", "issueValid"); 
		param.put("configValue", serverProperty.getIssueValid() );
		sqlSessionTemplate.insert("saveAcotpConfiguration", param);
		
		param.put("configKey", "issueLimit"); 
		param.put("configValue", serverProperty.getIssueLimit() );
		sqlSessionTemplate.insert("saveAcotpConfiguration", param);
		
		param.put("configKey", "userLimit"); 
		param.put("configValue", serverProperty.getUserLimit() );
		sqlSessionTemplate.insert("saveAcotpConfiguration", param);
		
		param.put("configKey", "gracePeriod"); 
		param.put("configValue", serverProperty.getGracePeriod() );
		sqlSessionTemplate.insert("saveAcotpConfiguration", param);
	}
}
