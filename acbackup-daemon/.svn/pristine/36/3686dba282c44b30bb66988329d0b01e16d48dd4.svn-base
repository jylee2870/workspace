package sga.sol.ac.acotp.daemon.process.authentication;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.stereotype.Service;

import sga.sol.ac.acotp.manager.exception.AcotpException;
import sga.sol.ac.acotp.manager.key.entity.KeyStatus;
import sga.sol.ac.acotp.manager.key.service.AcotpKeyService;

@Service
public abstract class AbstractProcess {
	
	public static final int OTP_TOTP_TYPE = 1;
	public static final int OTP_HOTP_TYPE = 2;
	
	@Autowired
	@Qualifier("AcotpKeyService")
	public AcotpKeyService acotpKeyService;
	
	
	public String getSecretKeyByUserId(String userId) throws AcotpException {
		return acotpKeyService.getSecretKeyByUserId(userId);
	}
	
	public KeyStatus getKeyStatusByUserId(String userId) throws AcotpException {
		return acotpKeyService.getKeyStatusByUserId(userId);
	}
	
	protected abstract String getUserPassword(String userId) throws AcotpException;
	
	protected abstract boolean authorize(String userId, String otpPassword) throws AcotpException; 
	
	protected abstract int getOtpType();
	
}
